

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; Documentation Docs Mineweb Lasted</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="prev" title="Documentations Mineweb" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Docs Mineweb
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#c-est-quoi-mineweb">C’est quoi MineWeb ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pre-requis">Pré-requis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#etape-1-configuration-de-la-base-de-donnees">Étape 1 - Configuration de la base de données</a></li>
<li class="toctree-l2"><a class="reference internal" href="#etape-2-creation-de-l-administrateur">Étape 2 - Création de l’administrateur</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-terminee">Installation terminée</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#lier-serveur-site">Lier serveur-site</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration-prealable">Configuration préalable</a></li>
<li class="toctree-l2"><a class="reference internal" href="#liaison-a-un-serveur-par-defaut">Liaison à un serveur (par défaut)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#liaison-par-rcon">Liaison par RCON</a></li>
<li class="toctree-l2"><a class="reference internal" href="#liaison-par-ping">Liaison par PING</a></li>
<li class="toctree-l2"><a class="reference internal" href="#la-connexion-echoue">La connexion échoue</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#creer-un-plugin">Créer un plugin</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creation">Création</a></li>
<li class="toctree-l2"><a class="reference internal" href="#les-tables-sql">Les tables SQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#callbacks">Callbacks</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Docs Mineweb</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="c-est-quoi-mineweb">
<h2>C’est quoi MineWeb ?<a class="headerlink" href="#c-est-quoi-mineweb" title="Lien permanent vers ce titre">¶</a></h2>
<p>MineWeb est un <strong>CMS</strong>. Un CMS est un système de gestion de contenu. Plus précisément il vous permet de vous créer rapidement et facilement un site complètement personnalisable. MineWeb est la version 2 de l’ancien CMS <strong>LapisCraft</strong> de Eywek. Celui-ci n’étant plus stable et mal développé (cf. raisons <a class="reference external" href="https://eywek.fr/lc-explications.pdf">ici</a>).</p>
<p>MineWeb est développé sous un framework PHP nommé <strong>CakePHP</strong> permettant un développement plus <strong>rapide</strong>, <strong>sécurisé</strong> et <strong>optimisé</strong>. Le projet a été lancé en 2015 en compagnie de <strong>Mac’</strong> permettant de convenir entièrement à <strong>vos besoins</strong>.</p>
</div>
<div class="section" id="pre-requis">
<h2>Pré-requis<a class="headerlink" href="#pre-requis" title="Lien permanent vers ce titre">¶</a></h2>
<p>Pour installer le CMS MineWeb votre hébergeur <strong>doit</strong> avoir :</p>
<ul class="simple">
<li><p>Version PHP supérieure ou égale à 5.6 et inférieure ou égale à 7.3</p></li>
<li><p>PDO activé</p></li>
<li><p>cURL activé</p></li>
<li><p>Réécriture d’URL</p></li>
<li><p>.htaccess activés</p></li>
<li><p>La librairie GD2</p></li>
<li><p>La possibilité d’ouvrir un zip</p></li>
<li><p>La possibilité d’ouvrir un site à distance</p></li>
<li><p>OpenSSL</p></li>
</ul>
<p>Pour plus de simplicité vous pouvez télécharger le <strong>fichier de compatibilité</strong> <a class="reference external" href="https://docs.mineweb.org/files/compatibilite.zip">ici</a>. Vous avez juste à extraire cette archive sur votre FTP pour voir si votre hébergeur est compatible.</p>
</div>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Lien permanent vers ce titre">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Vous devez placer tout le contenu de l’archive téléchargée, sur votre hébergeur (les fichiers .DS_Store &amp; __MACOSX sont inutiles). Il faut ensuite appliquer les permissions <strong>777</strong> sur tous les fichiers en <strong>recursif</strong> (pour permettre les mises à jour). Puis rendez-vous sur <a class="reference external" href="http://votresite.fr">http://votresite.fr</a></p>
</div>
<div class="section" id="etape-1-configuration-de-la-base-de-donnees">
<h2>Étape 1 - Configuration de la base de données<a class="headerlink" href="#etape-1-configuration-de-la-base-de-donnees" title="Lien permanent vers ce titre">¶</a></h2>
<p>Vous devez avoir une page demandant vos identifiants de base de données, vous devez entrez ceux-ci et tester la connexion, puis il vous faudra cliquer sur un bouton qui installera la base de données automatiquement.</p>
</div>
<div class="section" id="etape-2-creation-de-l-administrateur">
<h2>Étape 2 - Création de l’administrateur<a class="headerlink" href="#etape-2-creation-de-l-administrateur" title="Lien permanent vers ce titre">¶</a></h2>
<p>Voici la deuxième et dernière étape de l’installation du CMS, vous allez créer votre compte administrateur qui vous permettra d’accéder au panel admin du CMS. Vous avez juste à remplir les champs qui vous sont présentés et à soumettre vos informations en cliquant sur le bouton <strong>“Suivant”</strong>.</p>
</div>
<div class="section" id="installation-terminee">
<h2>Installation terminée<a class="headerlink" href="#installation-terminee" title="Lien permanent vers ce titre">¶</a></h2>
<p>Une fois l’installation du CMS complétée vous pouvez passer à l’utilisation du CMS en lui-même. Pour configurer votre CMS il vous faut vous connecter en cliquant sur le bouton en haut à gauche de la barre de navigation. Vous cliquez sur connexion puis entrez vos informations pour vous connecter. Vous cliquez ensuite sur <strong>Panel administrateur</strong>, vous serez redirigé et vous pourrez ensuite cliquer sur <strong>Général</strong> puis <strong>Préférences générales</strong>.</p>
</div>
</div>
<div class="section" id="lier-serveur-site">
<h1>Lier serveur-site<a class="headerlink" href="#lier-serveur-site" title="Lien permanent vers ce titre">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p><strong>Le plugins est compatibles à partir de la version 1.8</strong></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Type de connexion</strong>:</p>
<ul class="simple">
<li><p><strong>Par Défaut</strong> : connexion à un serveur lié avec le plugin <a class="reference external" href="https://github.com/MineWeb/ServerBridge/raw/master/mineweb_bridge-2.0.0.jar">Bukkit/Spigot</a>, permet l’utilisation de toutes les fonctionnalités du CMS (<strong>boutique, classement factions, vote</strong>…)</p></li>
<li><p><strong>Par Rcon</strong> : connexion à un serveur lié avec le Rcon. Pour la liaison d’un serveur Bungee, utilisez le Plugin Bungeecord RCON, permet l’utilisation de toutes les fonctionnalités du CMS mais pas du classement factions</p></li>
<li><p><strong>Par Ping</strong> : connexion à un serveur sans plugin, permet uniquement d’avoir le nombre de joueurs en ligne et le nombre de joueurs maximums (la <strong>boutique</strong> et le <strong>classement factions</strong> ne <strong>pourront pas</strong> être utilisés avec ce type de connexion)</p></li>
</ul>
</div>
<div class="section" id="configuration-prealable">
<h2>Configuration préalable<a class="headerlink" href="#configuration-prealable" title="Lien permanent vers ce titre">¶</a></h2>
<p>Rendez-vous sur la page de liaison site-serveur sur le panel admin de votre CMS. Vous devez dans un premier temps configurer le temps d’exécution maximum (appelé aussi timeout), il est conseillé de mettre 1 (seconde).</p>
<img alt="https://docs.mineweb.org/images/server_timeout.png" src="https://docs.mineweb.org/images/server_timeout.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Vous avez à côté deux boutons pour désactiver la fonctionnalité (qui mettra automatiquement le statut du serveur à : éteint) si vous ne souhaitez pas utiliser la liaison site-serveur. Et un autre bouton pour activer/désactiver le cache sur la “bannière” (permet que le message affiché sur le site (joueurs connectés, MOTD…) soit stocké pendant quelques minutes permettant d’éviter la surcharge de commande au serveur).</p>
</div>
</div>
<div class="section" id="liaison-a-un-serveur-par-defaut">
<h2>Liaison à un serveur (par défaut)<a class="headerlink" href="#liaison-a-un-serveur-par-defaut" title="Lien permanent vers ce titre">¶</a></h2>
<p>Maintenant nous allons lier votre serveur Minecraft au <strong>CMS</strong>. Pour cela vous devez avoir installé sur votre serveur le plugin MineWeb disponible à <a class="reference external" href="https://github.com/MineWeb/ServerBridge/raw/master/mineweb_bridge-2.0.0.jar">cette adresse</a></p>
<p>Une fois le plugin téléchargé, placez-le dans votre dossier <code class="docutils literal notranslate"><span class="pre">plugins</span></code> de votre serveur et <strong>redémarrez celui-ci</strong>.
Vous n’avez pas à toucher à la configuration du plugin.</p>
<p>Maintenant que vous avez configuré le serveur vous pouvez ajouter un serveur et remplir les informations nécessaires :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Type</span> <span class="pre">de</span> <span class="pre">la</span> <span class="pre">connexion</span></code> mettez <strong>Par défaut</strong></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nom</span></code> par le nom affiché.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IP</span></code> par l’ip (ou domaine) sans le port.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Port</span></code> par le port de votre serveur (25565 par défaut si vous n’avez pas de port).</p></li>
</ul>
<p>Cliquez ensuite sur <strong>Connexion</strong> pour tester la connexion, si celle-ci échoue, rendez-vous sur <a class="reference external" href="https://docs-mineweb.tk/docs.html#la-connexion-echoue">cette section</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Port customisé :</strong> Vous pouvez également configurer un port personnalisé si vous ne souhaitez pas utiliser le port minecraft de votre serveur. Pour cela, assurez-vous d’avoir un port disponible et ouvert et effectuez la commande <strong>/mineweb port &lt;port&gt;</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>ProtocolLib :</strong> Si vous avez ProtocolLib et que le plugin produit une erreur à cause du plugin de MineWeb vous pouvez utiliser <a class="reference external" href="https://github.com/MineWeb/ServerBridge/raw/no-injector/mineweb_bridge-2.0.0.jar">cette version</a>. Vous devez obligatoirement configurer un port disponible et ouvert à l’aide la commande <strong>/mineweb port &lt;port&gt;</strong>.</p>
</div>
</div>
<div class="section" id="liaison-par-rcon">
<h2>Liaison par RCON<a class="headerlink" href="#liaison-par-rcon" title="Lien permanent vers ce titre">¶</a></h2>
<p>Vous n’avez pas besoin de plugin pour cette liaison. Le protocol RCON est disponible sur tous les serveurs minecraft et permet de communiquer avec le site. Pour utiliser ce protocol il vous faut le configurer dans votre server.properties :</p>
<ul class="simple">
<li><p>Passer enable-rcon à true</p></li>
<li><p>Changer rcon.password par un mot de passe</p></li>
<li><p>Changer rcon.port par un port disponible</p></li>
</ul>
<p>Il vous suffit ensuite de configurer un serveur comme ceci depuis la page de liaison :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Type</span> <span class="pre">de</span> <span class="pre">la</span> <span class="pre">connexion</span></code> mettez <strong>RCON</strong>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nom</span></code> par le nom affiché.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IP</span></code> par l’ip (ou domaine) <strong>sans le port</strong>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Port</span></code> par le port de votre serveur (25565 par défaut si vous n’avez pas de port).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Port</span> <span class="pre">RCON</span></code> par le port de RCON configureé (doit être <strong>ouvert</strong> et <strong>disponible</strong> bien sûr).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Mot</span> <span class="pre">de</span> <span class="pre">passe</span> <span class="pre">RCON</span></code> par le mot de passe RCON.</p></li>
</ul>
<p>Cliquez ensuite sur <strong>Connexion</strong> pour tester la connexion.</p>
</div>
<div class="section" id="liaison-par-ping">
<h2>Liaison par PING<a class="headerlink" href="#liaison-par-ping" title="Lien permanent vers ce titre">¶</a></h2>
<p>Vous n’avez pas besoin de plugin pour cette liaison, il vous suffit juste de configurer un serveur comme ceci depuis la page de liaison :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Type</span> <span class="pre">de</span> <span class="pre">la</span> <span class="pre">connexion</span></code> mettez <strong>Ping</strong>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nom</span></code> par le nom affiché.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IP</span></code> par l’ip (ou domaine) <strong>sans le port</strong>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Port</span></code> par le port de votre serveur (25565 par défaut si vous n’avez pas de port).</p></li>
</ul>
<p>Cliquez ensuite sur <strong>Connexion</strong> pour tester la connexion.</p>
</div>
<div class="section" id="la-connexion-echoue">
<h2>La connexion échoue<a class="headerlink" href="#la-connexion-echoue" title="Lien permanent vers ce titre">¶</a></h2>
<p>Dans un premier temps, vérifiez que vous n’avez pas d’erreur dans la console de votre serveur en rapport avec le plugin MineWeb.</p>
<p>Ensuite, essayez de <strong>redémarrer votre serveur</strong>.</p>
<p>Si la connexion échoue toujours, venez-nous voir sur <a class="reference external" href="https://discordapp.com/invite/3QYdt8r">Discord</a> avec un <strong>maximum d’explications et d’informations</strong>, et répondez à ces questions :</p>
<ul class="simple">
<li><p>Quelle IP avez-vous mis ?</p></li>
<li><p>Quel port ?</p></li>
<li><p>Aucune erreur dans la console ?</p></li>
<li><p>Quelle version de Spigot avez-vous ?</p></li>
<li><p>Avez-vous essayé de rédemarrer le serveur ?</p></li>
<li><p>Fournissez-nous des <strong>logs</strong> de démarrage du serveur sur pastebin.com</p></li>
<li><p>Fournissez-nous le fichier <strong>mineweb.log</strong> du plugin sur pastebin.com</p></li>
</ul>
</div>
</div>
<div class="section" id="creer-un-plugin">
<h1>Créer un plugin<a class="headerlink" href="#creer-un-plugin" title="Lien permanent vers ce titre">¶</a></h1>
<p><strong>Introduction</strong></p>
<p>Un plugin (aussi appelé <em>extension</em>), est un ensemble de <strong>fichiers</strong> qui sont ajoutés à votre CMS pour y ajouter plusieurs <strong>fonctionnalités</strong> ou modifier certains <strong>comportements</strong> par défaut. Différents plugins “officiels” sont <em>déjà disponibles</em> <a class="reference external" href="https://github.com/MineWeb?utf8=%E2%9C%93&amp;q=Plugin-&amp;type=&amp;language=php">ici</a>. D’autres peuvent être <em>développés par la communauté</em> et c’est le but de ce tutoriel.</p>
<div class="section" id="creation">
<h2>Création<a class="headerlink" href="#creation" title="Lien permanent vers ce titre">¶</a></h2>
<p><strong>Création des fichiers/dossiers</strong></p>
<p>Dans un premier temps, il va falloir créer le dossier de votre plugin, ce dossier doit être créé dans le dossier <cite>app/Plugin/</cite>. Le nom du dossier doit être le nom de votre plugin.</p>
<p>Par <strong>exemple</strong> si je veux créer un plugin de <strong>boutique</strong>, je vais l’appeler : <strong>Shop</strong>.</p>
<p>Une fois ce dossier créé, il faut créer différents autres dossiers et fichiers :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Config/</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Controller/</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Model/</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">View/</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lang/</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SQL/</span></code></p></li>
</ul>
<p>C’est tout pour les dossiers, il nous reste maintenant encore des fichiers à créer tels que :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Config/bootstrap.php</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Config/routes.php</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">config.json</span></code></p></li>
</ul>
<p><strong>Explications et configuration</strong></p>
<p>Maintenant que vous avez créé tous ces fichiers, nous allons passer à la configuration de votre plugin. Pour cela, ouvrez le fichier <strong>config.json</strong>, c’est dans ce fichier que toute la configuration sera située.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Configuration par défaut (à remplir)
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span>
<span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="s2">&quot;AUTHOR&quot;</span><span class="p">,</span>
<span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="nt">&quot;useEvents&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
<span class="nt">&quot;permissions&quot;</span> <span class="p">:</span> <span class="p">{</span>
  <span class="nt">&quot;available&quot;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;default&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;0&quot;</span> <span class="p">:</span> <span class="p">[],</span>
    <span class="nt">&quot;2&quot;</span> <span class="p">:</span> <span class="p">[]</span>
  <span class="p">}</span>
<span class="p">},</span>
<span class="nt">&quot;requirements&quot;</span> <span class="p">:</span> <span class="p">{</span>
  <span class="nt">&quot;CMS&quot;</span> <span class="p">:</span> <span class="s2">&quot;^1.7.0&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Maintenant, vous allez pouvoir configurer. Remplacez <strong>NAME</strong> par le <em>nom de votre plugin</em> et puis <strong>AUTHOR</strong> par votre pseudo.
Ensuite voici une explication des autres lignes :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">version</span></code> : la version de votre plugin (<strong>double</strong>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">useEvents</span></code> : si votre plugin utilise les événements disponible sur le CMS (<strong>boolean</strong>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">permissions</span></code> : les permissions de votre plugin (voir plus tard) (<strong>array</strong>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">requirements</span></code> : les pré-requis de votre plugin : vous devez spécifier comme clé un autre ID de plugin (au format <strong>auteur.slug</strong>) ou CMS et comme valeur une version correcte (cf. le semantic versionning donc préfixée ou non par ^ / ~ / &gt;= / &lt;=). Si un des pré-requis n’est pas rempli, le plugin ne sera pas installé sur le CMS.</p></li>
</ul>
<p><strong>Les liens de la barre de navigation</strong></p>
<p>Si votre plugin dispose d’une route publique (pouvant être accessible pour n’importe quel utilisateur) il peut être important de configurer lesquelles de ces routes peuvent être ajoutées sur la barre de navigation depuis le panel admin. Pour cela, il vous suffit d’ajouter la clé <code class="docutils literal notranslate"><span class="pre">navbar_routes</span></code> dans le fichier <code class="docutils literal notranslate"><span class="pre">config.json</span></code>.
Cette clé doit contenir un objet avec comme clé le nom de la route et comme valeur la route.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
     <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Boutique&quot;</span><span class="p">,</span>
     <span class="nt">&quot;admin_menus&quot;</span><span class="p">:</span> <span class="p">{},</span>
     <span class="nt">&quot;navbar_routes&quot;</span><span class="p">:</span> <span class="p">{</span>
             <span class="nt">&quot;Boutique&quot;</span><span class="p">:</span> <span class="s2">&quot;/shop&quot;</span>
     <span class="p">},</span>
     <span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="s2">&quot;Eywek&quot;</span><span class="p">,</span>
     <span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
     <span class="nt">&quot;useEvents&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
     <span class="nt">&quot;permissions&quot;</span> <span class="p">:</span> <span class="p">{</span>
             <span class="nt">&quot;available&quot;</span> <span class="p">:</span> <span class="p">[],</span>
             <span class="nt">&quot;default&quot;</span> <span class="p">:</span> <span class="p">{</span>
                     <span class="nt">&quot;0&quot;</span> <span class="p">:</span> <span class="p">[],</span>
                     <span class="nt">&quot;2&quot;</span> <span class="p">:</span> <span class="p">[]</span>
             <span class="p">}</span>
     <span class="p">},</span>
     <span class="nt">&quot;requirements&quot;</span> <span class="p">:</span> <span class="p">{</span>
             <span class="nt">&quot;CMS&quot;</span> <span class="p">:</span> <span class="s2">&quot;^1.2.0&quot;</span>
       <span class="p">}</span>
     <span class="p">}</span>
</pre></div>
</div>
<p><strong>Les menus panel admin</strong></p>
<p>Vous pouvez, si vous le souhaitez, avoir un menu au niveau du panel admin avec des sous-liens (comme pour la boutique). Pour ceci, il vous suffit d’ajouter la clé <code class="docutils literal notranslate"><span class="pre">admin_menus</span></code> dans la configuration du plugin.
La clé sera le nom du menu, vous pouvez utilisez des noms déjà utilisés pour placer votre menu en tant que sous-menu d’un déjà présent (comme sur l’exemple). Vous pouvez alors ajouter un index pour être après tel ou tel sous-menu
Les clés du panel admin sont les suivantes</p>
<table class="colwidths-given docutils align-center">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Valeur</p></th>
<th class="head"><p>Explication</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Dashboard</span></code></p></td>
<td><p>Correspondant au menu ‘Dashboard” du panel admin</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">GLOBAL__ADMIN_GENERAL</span></code></p></td>
<td><p>Correspondant au menu “Général” du panel admin</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GLOBAL__CUSTOMIZE</span></code></p></td>
<td><p>Correspondant au menu “Personnalisation” du panel admin</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SERVER__TITLE</span></code></p></td>
<td><p>Correspondant au menu “Serveur” du panel admin</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GLOBAL__ADMIN_OTHER_TITLE</span></code></p></td>
<td><p>Correspondant au menu “Autres” du panel admin</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">STATS__TITLE</span></code></p></td>
<td><p>Correspondant au menu “Statistiques” du panel admin</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MAINTENANCE__TITLE</span></code></p></td>
<td><p>Correspondant au menu “Maintenance” du panel admin</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">GLOBAL__UPDATE</span></code></p></td>
<td><p>Correspondant au menu “Mise à jour” du panel admin</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">HELP__TITLE</span></code></p></td>
<td><p>Correspondant au menu “Aide” du panel admin</p></td>
</tr>
</tbody>
</table>
<p>La valeur doit ensuite être un objet contenu l’<code class="docutils literal notranslate"><span class="pre">icon</span></code>, la <code class="docutils literal notranslate"><span class="pre">route</span></code> ou le <code class="docutils literal notranslate"><span class="pre">menu</span></code> (et optionnelement <code class="docutils literal notranslate"><span class="pre">permission</span></code> et <code class="docutils literal notranslate"><span class="pre">index</span></code>)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Associez-lui comme valeur un tableau avec vos sous-liens, comme ceci par exemple :
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span>
 <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span>
 <span class="nt">&quot;admin_menus&quot;</span><span class="p">:</span> <span class="p">{</span>
  <span class="nt">&quot;GLOBAL__CUSTOMIZE&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;Boutique&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;index&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="nt">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;shopping-cart&quot;</span><span class="p">,</span>
      <span class="nt">&quot;menu&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;Gérer les articles&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;shopping-basket&quot;</span><span class="p">,</span>
          <span class="nt">&quot;permission&quot;</span><span class="p">:</span> <span class="s2">&quot;SHOP__ADMIN_MANAGE_ITEMS&quot;</span><span class="p">,</span>
          <span class="nt">&quot;route&quot;</span><span class="p">:</span> <span class="s2">&quot;/admin/shop&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;Gérer les promotions&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;percent&quot;</span><span class="p">,</span>
          <span class="nt">&quot;permission&quot;</span><span class="p">:</span> <span class="s2">&quot;SHOP__ADMIN_MANAGE_VOUCHERS&quot;</span><span class="p">,</span>
          <span class="nt">&quot;route&quot;</span><span class="p">:</span> <span class="s2">&quot;/admin/shop/shop/vouchers&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;Gérer les paiements&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;credit-card&quot;</span><span class="p">,</span>
          <span class="nt">&quot;permission&quot;</span><span class="p">:</span> <span class="s2">&quot;SHOP__ADMIN_MANAGE_PAYMENT&quot;</span><span class="p">,</span>
          <span class="nt">&quot;route&quot;</span><span class="p">:</span> <span class="s2">&quot;/admin/shop/payment&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">},</span>
      <span class="nt">&quot;navbar_routes&quot;</span><span class="p">:</span> <span class="p">{</span>
  <span class="nt">&quot;Boutique&quot;</span><span class="p">:</span> <span class="s2">&quot;/shop&quot;</span>
<span class="p">},</span>
<span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="s2">&quot;AUTHOR&quot;</span><span class="p">,</span>
<span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="nt">&quot;useEvents&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
<span class="nt">&quot;permissions&quot;</span> <span class="p">:</span> <span class="p">{</span>
  <span class="nt">&quot;available&quot;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;default&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;0&quot;</span> <span class="p">:</span> <span class="p">[],</span>
    <span class="nt">&quot;2&quot;</span> <span class="p">:</span> <span class="p">[]</span>
  <span class="p">}</span>
<span class="p">},</span>
<span class="nt">&quot;requirements&quot;</span> <span class="p">:</span> <span class="p">{</span>
  <span class="nt">&quot;CMS&quot;</span> <span class="p">:</span> <span class="s2">&quot;^1.2.0&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>La clé <code class="docutils literal notranslate"><span class="pre">permission</span></code> dans chaque lien est optionnelle, elle permet d’afficher le lien seulement si la permission est accordée au groupe de l’utilisateur.</p>
</div>
<div class="section" id="les-tables-sql">
<h2>Les tables SQL<a class="headerlink" href="#les-tables-sql" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les tables dont vous avez besoin pour votre plugin vont être générées automatiquement par un shell.
Dans un premier temps, toutes les tables de votre plugin doivent être préfixées par le nom de votre plugin.
Par exemple, pour le plugin Shop les tables doivent être préfixés par <strong>shop_</strong></p>
<p>Pour générer vos tables automatiquement dans un schema (qui sera <strong>indispensable</strong> pour avoir un plugin valide) il vous faut vous rendre sur le SSH de votre serveur dédié/VPS/ordinateur pour pouvoir utiliser la console de CakePHP. Il vous faut ensuite vous rendre dans le dossier contenant les fichiers du CMS puis, il vous faudra taper
<code class="docutils literal notranslate"><span class="pre">app/Console/cake</span> <span class="pre">schema</span> <span class="pre">generate</span> <span class="pre">plugin-shop</span></code>
Un fichier <em>schema.php</em> sera automatiquement créé dans le dossier SQL de votre plugin.</p>
<p>Si vous ne pouvez pas accéder à la console de CakePHP, vous pouvez toujours créer votre fichier <em>SQL/schema.php</em> <strong>manuellement</strong>.</p>
<p>Vous devez commençer le fichier comme ceci:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x"> </span><span class="cp">&lt;?php</span>
  <span class="k">class</span> <span class="nc">ShopAppSchema</span> <span class="k">extends</span> <span class="nx">CakeSchema</span> <span class="p">{</span>

  <span class="k">public</span> <span class="nv">$file</span> <span class="o">=</span> <span class="s1">&#39;schema.php&#39;</span><span class="p">;</span>

  <span class="k">public</span> <span class="k">function</span> <span class="nf">before</span><span class="p">(</span><span class="nv">$event</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="nf">after</span><span class="p">(</span><span class="nv">$event</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="callbacks">
<h2>Callbacks<a class="headerlink" href="#callbacks" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les <strong>callbacks</strong> sont des fonctions appelées automatiquement par le CMS lors de certaines actions.</p>
<p>Vous pouvez, si vous le souhaitez, créer un fichier <strong>MainComponent.php</strong> dans le dossier <code class="docutils literal notranslate"><span class="pre">Controller/Component</span></code> de votre plugin.</p>
<p>Dans ce fichier vous pouvez y ajouter :</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">MainComponent</span> <span class="k">extends</span> <span class="nx">Object</span> <span class="p">{</span>

 <span class="k">public</span> <span class="k">function</span> <span class="nf">onEnable</span><span class="p">()</span> <span class="p">{</span>
 <span class="p">}</span>

 <span class="k">public</span> <span class="k">function</span> <span class="nf">onDisable</span><span class="p">()</span> <span class="p">{</span>
 <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Ces fonctions <strong>onEnable</strong> et <strong>onDisable</strong> seront <strong>automatiquement</strong> appelées par le CMS lors de l’<strong>installation</strong>, l’<strong>activation</strong> <em>(pour le onEnable)</em>, et pour la <strong>désinstallation</strong> et la <strong>désactivation</strong> <em>(pour le onDisable)</em> du plugin.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Documentations Mineweb" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Mineweb

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>